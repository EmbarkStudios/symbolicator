<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Symbol Server Compatibility - Symbolicator</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Symbol Server Compatibility";
    var mkdocs_page_input_path = "symbol-server-compatibility.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Symbolicator</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Symbolicator</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../background-and-principles/">Background and Principles</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../caching/">Internal Caching</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../symbol-lookup/">Symbol lookup strategy</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Symbol Server Compatibility</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#symbol-server-compatibility">Symbol Server Compatibility</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#identifiers">Identifiers</a></li>
        
            <li><a class="toctree-l3" href="#a-note-on-case-sensitivity">A Note on Case Sensitivity</a></li>
        
            <li><a class="toctree-l3" href="#breakpad">Breakpad</a></li>
        
            <li><a class="toctree-l3" href="#microsoft-symbol-server">Microsoft Symbol Server</a></li>
        
            <li><a class="toctree-l3" href="#microsoft-ssqp-symbol-server">Microsoft SSQP Symbol Server</a></li>
        
            <li><a class="toctree-l3" href="#lldb-debugger-macos">LLDB Debugger (macOS)</a></li>
        
            <li><a class="toctree-l3" href="#gdb">GDB</a></li>
        
            <li><a class="toctree-l3" href="#other-servers">Other servers</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../symbolication-api/">Symbolication API</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../system-architecture/">System Architecture</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Symbolicator</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Symbol Server Compatibility</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="symbol-server-compatibility">Symbol Server Compatibility</h1>
<p>This page describes external sources supported by Symbolicator.</p>
<p>The layout of external sources intends to be compatible to several symbol server implementations that have been used historically by different platforms. We commit to provide compatibility to the following services or directory structures:</p>
<ul>
<li>Microsoft Symbol Server</li>
<li>Breakpad Symbol Repositories</li>
<li>LLDB File Mapped UUID Directories</li>
<li>GDB Build ID Directories</li>
</ul>
<h2 id="identifiers">Identifiers</h2>
<p>There are two fundamentally different identifiers. Their semantics fundamentally depend on the symbol type, but follow certain rules:</p>
<ul>
<li><strong>Code Identifier:</strong> Identifies the actual executable or library file (e.g. EXE or DLL)</li>
<li><strong>Debug Identifier:</strong> Identifies a debug companion file (e.g. PDB)</li>
</ul>
<p>On all platforms other than Windows, binaries and debug companion files use the same file type and share the same container. The Breakpad library has thus changed the semantics of those identifiers for all other platforms to:</p>
<ul>
<li><strong>Code Identifier:</strong> The original platform-specific identifier</li>
<li><strong>Debug Identifier:</strong> A potentially lossy transformation of the code identifier into a unified format similar to the PDB debug identifiers.</li>
</ul>
<p>Specifically, the code and debug identifiers are defined as follows:</p>
<ul>
<li><strong>ELF</strong></li>
<li><strong>MachO</strong></li>
<li><strong>PE</strong> / <strong>PDB</strong></li>
<li><strong>Breakpad</strong></li>
</ul>
<h2 id="a-note-on-case-sensitivity">A Note on Case Sensitivity</h2>
<p>Most symbol servers explicitly define <strong>case insensitive</strong> lookup semantics. This goes in particular for the Microsoft Public Symbol Server. However, the canonical representation on the file system is not necessarily case insensitive, for example when the files are stored on an Amazon S3 bucket. Since this is a hard restriction, the case for lookups is explicitly defined for each source below. Please pay attention to the casing rules!</p>
<h2 id="breakpad">Breakpad</h2>
<p>Breakpad always computes a "Breakpad ID" for each symbol. This is a lossy process depending on the file type. Sentry stores a bidirectionally compatible version of this in the <code>debug_id</code> field.</p>
<p>The name of the symbol file is platform dependent. On Windows, the file extension (Either <em>.exe</em>, <em>.dll</em> or <em>.pdb</em>) is replaced with <em>.sym</em>. On all other platforms, the <em>.sym</em> extension is <strong>appended</strong> to the full file name including potential extensions.</p>
<p>Casing rules are mixed:</p>
<ul>
<li>The file name is <strong>as given</strong></li>
<li>The signature part of the id (first 32 characters) are <strong>uppercase</strong></li>
<li>
<p>The age part of the id (remaining characters) are <strong>lowercase</strong></p>
</li>
<li>
<p><strong>Schema</strong>: <code>&lt;debug_name&gt;/&lt;breakpad-id&gt;/&lt;sym_name&gt;</code></p>
</li>
</ul>
<h2 id="microsoft-symbol-server">Microsoft Symbol Server</h2>
<p>The public symbol server provided by Microsoft used to only host PDBs for the Windows platform. These use a <em>signature-age</em> debug identifier in addition to the file name to locate symbols. For .NET, this specification was amended by a schema for ELF and MachO-symbols, which is specified as <a href="https://github.com/dotnet/symstore/blob/master/docs/specs/SSQP_Key_Conventions.md">SSQP Key Conventions</a>. This means all non windows platforms are following SSQP rules except for casing.</p>
<p>Casing rules for Symbol Server are mixed:</p>
<ul>
<li>Filenames are <strong>as given</strong></li>
<li>Identifiers are generally <strong>lowercase</strong>, except:</li>
<li>The signature and age of a PDB identifier is <strong>uppercase</strong>.</li>
<li>
<p>The timestamp of a PE identifier is <strong>uppercase</strong> except the size is <strong>lowercase</strong></p>
</li>
<li>
<p><strong>PE</strong>: <code>&lt;code_name&gt;/&lt;Timestamp&gt;&lt;SizeOfImage&gt;/&lt;code_name&gt;</code></p>
</li>
<li><strong>PDB</strong>: <code>&lt;debug_name&gt;/&lt;Signature&gt;&lt;Age&gt;/&lt;debug_name&gt;</code></li>
<li><strong>ELF</strong> (binary, potentially stripped): <code>&lt;code_name&gt;/elf-buildid-&lt;note_byte_sequence&gt;/&lt;code_name&gt;</code></li>
<li><strong>ELF</strong> (debug info): <code>_.debug/elf-buildid-sym-&lt;note_byte_sequence&gt;/_.debug</code></li>
<li><strong>MachO</strong> (binary): <code>&lt;code_name&gt;/mach-uuid-&lt;uuid_bytes&gt;/&lt;code_name&gt;</code></li>
<li><strong>MachO</strong> (dSYM): <code>_.dwarf/mach-uuid-sym-&lt;uuid_bytes&gt;/_.dwarf</code></li>
</ul>
<p>The presence of a <code>index2.txt</code> in the root indicates two tier structure where the first two characters are prepended to the path as an additional folder. So <code>foo.exe/542D5742000f2000/foo.exe</code> is stored as <code>fo/foo.exe/542D5742000f2000/foo.exe</code>.</p>
<h2 id="microsoft-ssqp-symbol-server">Microsoft SSQP Symbol Server</h2>
<p>Casing rules for SSQP are mixed:</p>
<ul>
<li>Filenames are <strong>lowercased</strong></li>
<li>Identifiers are generally <strong>lowercase</strong>, except:</li>
<li>
<p>The age of a PDB identifier is <strong>uppercase</strong>.</p>
</li>
<li>
<p><strong>PE</strong>: <code>&lt;code_name&gt;/&lt;Timestamp&gt;&lt;SizeOfImage&gt;/&lt;code_name&gt;</code></p>
</li>
<li><strong>PDB</strong>: <code>&lt;debug_name&gt;/&lt;Signature&gt;&lt;Age&gt;/&lt;debug_name&gt;</code></li>
<li><strong>ELF</strong> (binary, potentially stripped): <code>&lt;code_name&gt;/elf-buildid-&lt;note_byte_sequence&gt;/&lt;code_name&gt;</code></li>
<li><strong>ELF</strong> (debug info): <code>_.debug/elf-buildid-sym-&lt;note_byte_sequence&gt;/_.debug</code></li>
<li><strong>MachO</strong> (binary): <code>&lt;code_name&gt;/mach-uuid-&lt;uuid_bytes&gt;/&lt;code_name&gt;</code></li>
<li><strong>MachO</strong> (dSYM): <code>_.dwarf/mach-uuid-sym-&lt;uuid_bytes&gt;/_.dwarf</code></li>
</ul>
<p>Additionally, SSQP supports a lookup by SHA1 checksum over the file contents, commonly used for source file lookups. This will not be supported.</p>
<h2 id="lldb-debugger-macos">LLDB Debugger (macOS)</h2>
<p>The LLDB debugger on macOS can read debug symbols from <a href="http://lldb.llvm.org/use/symbols.html#file-mapped-uuid-directories">File Mapped UUID Directories</a> (scroll down to the second last section). The UUID is broken up by splitting the first 20 hex digits into 4 character chunks, and a directory is created for each chunk. In the final directory, LLDB usually expects a symlink named by the last 12 hex digits, which it follows to the actual dSYM file. </p>
<p><strong>Note</strong>: this is not actually an LLVM feature. This is in fact a feature of <code>CoreFoundation</code> and exclusively implemented on macOS on top of spotlight. Spotlight indexes these paths and the private <code>DBGCopyFullDSYMURLForUUID</code> API is used by lldb to locate the symbols. macOS uses the symlinks of those locations.</p>
<p>Since the executable or library shares the same UUID as the dSYM file, the former are distinguished with a <code>.app</code> suffix.</p>
<p>The hex digits are <strong>uppercase</strong>, the app suffix is <strong>lowercase</strong>.</p>
<ul>
<li><strong>MachO</strong> (binary): <code>XXXX/XXXX/XXXX/XXXX/XXXX/XXXXXXXXXXXX.app</code></li>
<li><strong>MachO</strong> (dSYM): <code>XXXX/XXXX/XXXX/XXXX/XXXX/XXXXXXXXXXXX</code></li>
</ul>
<h2 id="gdb">GDB</h2>
<p>GDB supports multiple lookup methods, depending on the way the debug info file is specified. However, not all of these methods are applicable to a symbol server:</p>
<ul>
<li><strong>Debug Link Method:</strong> GDB looks up the name or relative path specified in the <code>.gnu.debuglink</code> section. This requires the debug file to be in a relative position to the actual executable, and does not provide any means to distinguish by a unique identifier.</li>
<li><strong>Build ID Method:</strong> Assuming that a GNU build ID note or section have been written to the ELF file, this specifies a unique identifier for the executable which is also retained in the debug file. This method is applicable to a symbol server, but only if the Build ID is present.</li>
</ul>
<p>The GNU build ID is a variable-length binary string, usually consisting of a 20-byte SHA1 hash of the code section (<code>.text</code>). The lookup path is <em>nn/nnnnnnnn.debug</em>, where <em>nn</em> are the first 2 hex characters of the build ID bit string, and <em>nnnnnnnn</em> are the rest of the bit string. To look up executables, the <code>.debug</code> suffix is omitted.</p>
<p>The build-id hex representation is always provided in <strong>lowercase</strong>.</p>
<p><a href="https://sourceware.org/gdb/onlinedocs/gdb/Separate-Debug-Files.html">https://sourceware.org/gdb/onlinedocs/gdb/Separate-Debug-Files.html</a></p>
<ul>
<li><strong>ELF</strong> (binary, potentially stripped)</li>
<li><strong>ELF</strong> (debug info)</li>
</ul>
<h2 id="other-servers">Other servers</h2>
<p>The following additional sources were considered but are not implemented right now:</p>
<h3 id="fedora-darkserver">Fedora Darkserver</h3>
<p>In 2010, Fedora launched a project called "Darkserver" that aimed to provide a symbol server for various libraries. In 2012, it seemed to have contained symbols for Debian and Ubuntu as well.</p>
<p>However, this projects seems to have been abandoned since and there is only little information available. For now, there is no intention to support Darkserver.</p>
<h3 id="mozilla-tecken">Mozilla Tecken</h3>
<p>Tecken is the symbol server implementation used at Mozilla. The symbol file paths are compatible to Google's Breakpad symbol server. An example of available symbols can be viewed here: <a href="https://symbols.mozilla.org/downloads/missing">https://symbols.mozilla.org/downloads/missing</a>.</p>
<p>Tecken internally implements a client for the Microsoft Symbol Server to forward downloads for missing symbols. While doing that, it attempts to replace the last character in the URL with an underscore to look up compressed symbols. In any case Tecken tries both variants. Example: <code>foo.exe/&lt;id&gt;/foo.ex_</code>. Microsoft Symbol Server no longer supports this.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../symbolication-api/" class="btn btn-neutral float-right" title="Symbolication API">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../symbol-lookup/" class="btn btn-neutral" title="Symbol lookup strategy"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../symbol-lookup/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../symbolication-api/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
